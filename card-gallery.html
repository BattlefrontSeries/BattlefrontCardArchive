<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Gallery</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Styling for images and grid layout */
        .card-image {
            width: 150px;  /* Set the width of the images */
            height: auto;  /* Maintain aspect ratio */
            margin: 10px;  /* Set margin for spacing */
            cursor: pointer; /* Pointer cursor on hover */
        }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); /* Adjust grid based on available space */
            gap: 10px;  /* Set spacing between grid items */
        }
    </style>
</head>
<body>
    <header>
        <h1 id="galleryHeader"></h1>
    </header>
    <section>
        <div id="cardGrid" class="grid-container"></div>
    </section>

    <script>
        // Set the season and card type from local storage
        const season = localStorage.getItem('selectedSeason') || "BS_Season1"; // Default to BS Season 1
        const cardType = localStorage.getItem('selectedCardType') || "Base"; // Default to Base

        // Update the gallery header
        document.getElementById('galleryHeader').textContent = `${season.replace(/_/g, ' ')} - ${cardType} Cards`;

        // Function to load images dynamically
        async function loadImages() {
            const response = await fetch(`/api/images?season=${season}&cardType=${cardType}`);
            const images = await response.json();
            const cardGrid = document.getElementById('cardGrid');
            
            images.forEach((imageSrc, index) => {
                const img = document.createElement('img');
                img.src = imageSrc; // Use the fetched image source
                img.classList.add('card-image');
                img.onclick = () => openPopup(index); // Set the click event
                cardGrid.appendChild(img);
            });
        }

        // Function to open card popup
        function openPopup(index) {
            localStorage.setItem('selectedCardIndex', index); // Save selected image index
            window.location.href = 'card-popup.html'; // Redirect to card popup
        }

        // Load images when the page is ready
        loadImages();
    </script>
</body>
</html>
